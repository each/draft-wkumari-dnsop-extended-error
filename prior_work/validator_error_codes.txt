



???                                                      S. Krishnaswamy
                                                             SPARTA Inc.
Expires: September 24, 2005                               March 23, 2005


                         Validator Return Codes
                 draft-suresh-validator-return-codes-00


Abstract


1.  Introduction

   A validator is a piece of software that can check the validity of DNS
   data and messages.  Validation normally proceeds by verifying the
   signatures on the resource record being queried for, checking proofs
   for non-existence, if any, and constructing a chain-of-trust from the
   signature covering the record in question to a locally maintained
   trust-anchor.

   In performing these operations the validator may not be able to
   always return a conclusive "validated" or "not validated" answer;
   this document attempts to document all the codes that a validator may
   wish to return to an application.



Krishnaswamy           Expires September 24, 2005               [Page 1]

Internet-Draft           Validator Return Codes               March 2005


   The validator may have to make additional queries while doing
   validation.  We delegate the responsibility for sending queries and
   parsing responses to a different functionality (either built-in, or
   as a separate module), which we call the resolver.  This document
   does not list return codes that are specific to the resolver
   functionality.

2.  Return Codes

   The return codes specified in this document are categorized into four
   sections.  The first is a list-of-one and defines the generic
   non-error return code.  The second section lists the error codes that
   are returned when the validator encounters some error or condition
   that prevents it from successfully returning validation results.  The
   third set of return codes lists the different results of validation:
   success, failure and the various shades of gray in between.  The
   final set of return codes describes the transient return values
   generated by the validator when it validates a particular chain of
   trust.

2.1  Generic non-error return code

   0: No Error (was '0 -- OK').
      No errors have been encountered.

2.2  Error codes

   -1: Not Implemented (was '36 -- Not Implemented').
      The validator does not implement this functionality.
   -2: Out of Memory  (was '3 -- Resource Unavailable').
      The validator is not able to dynamically allocate memory.
   -3: Bad Argument.
      Bad argument passed to the validator.
   -4: Internal Error (was 37 -- Generic Error').
      "Catch-all" for generic errors.
   -5: No Permission (was '57 -- Not authorized to see error code ').
      The application invoking the validator API does not have
      sufficient permissions to view the returned status.
   -6: Resource unavaliable (was '3 -- Resource Unavailable').
      Some additional resources needed for DNSSEC validation are not
      available.
   -7: Config file Parse Error (was '56 -- Config file error ').
      The validator could not be initialized due to some error in
      parsing the configuration file.
   -8: No policy  (was '11 -- No policy ').






Krishnaswamy           Expires September 24, 2005               [Page 2]

Internet-Draft           Validator Return Codes               March 2005


      The validator could not be initialized because there was no
      validation policy specified.

2.3  Validation results

   1: Validation Success  (was '1 -- Secure ').
      The result was successfully validated.
   2: Bogus.
      The result is bogus.
   3: Indeterminate.
      Don't know if zone is unsigned, or signatures and other records
      have been stripped off.
   4: Provably un-secure (was '6 -- provably un-secure').
      The zone has been proved to not be a signed zone.
   5: Security lame (was '46 -- Security lame').
      Mismatch between the DNSKEY in a zone and the DS record in the
      parent
   6: Name expansion failure.
      CNAME and DNAME expansion failed sanity checks.

2.4  Transient codes

   7: No preferred SEP.
      The chain-of-trust does not follow a preferred SEP.
   8: No trust anchor  (was '5 -- No trust anchor').
      No trust anchor for this chain of trust.
   9: Too many links in validation chain  (was '10 -- too many links in
   chain').
      The chain of trust is too long.
   10: Trust anchor timeout  (was '45 -- Trust anchor timeout/dusty').
      This trust anchor must no longer be used.
   11: Over-reaching NSEC  (was '28 -- over-reaching NSEC').
      Next owner name in the NSEC record goes beyond another record that
      is known to exist.
   12: NSEC pointing upwards  (was '48 -- NSEC pointing upwards').
      The ordering of records in the NSEC chain does not follow
      canonical ordering rules.
   13: Irrelevant proof (was '26 -- irrelevant denial of existence').
      Proof of non-existence is not for the record whose non-existance
      was being proved.
   14: Incomplete proof (was '21 -- incomplete answer').
      Proof of non-existence is incomplete.
   15: Proved ownername missing.
      Successfully proved that a given ownername is missing.
   16: Proved type missing.






Krishnaswamy           Expires September 24, 2005               [Page 3]

Internet-Draft           Validator Return Codes               March 2005


      Successfully proved that a given type is missing.
   17: RRSIG verified.
      The RRSIG verified successfully.
   18: RRSIG does not verify (was '7 -- RRSIG does not verify').
      The signature in the RRSIG does not verify.
   19: Bare RRSIG.
      RRSIGs cannot be themselves validated.
   20: RRSIG expired (was '4 -- RRSIG expired').
      The RRSIG has crossed is useful lifetime.
   21: RRSIG not yet active (was '22 -- RRSIG not effective').
      The signature inception date is in the future.
   22: Key is too large (was '16 -- Key too large').
      Local policy disallows this key being used to validate a record on
      the grounds that it is too large.
   23: Key too small.
      Local policy disallows this key being used to validate a record on
      the grounds that it is too small.
   24: Key not authorized (was '17 -- Needed key not authorized ').
      Local policy does not authorize this key to be used for
      validation.
   25: Not a zone key (was '40 -- not a zone key').
      The key that is used to verify signatures on zone data is not a
      zone key.
   26: Clock skew (was '15 -- out of time sync').
      Signature is verifiable only if clock skew is taken into account.
   27: Algorithm refused (was '9 -- algo does not satisfy policy').
      Local policy disallows this algorithm.
   28: Unauthorized signer (was '27 -- Unauthorized signer').
      Local policy disallows accepting signatures created by this
      signer.
   29: RRSIG missing (was '8 -- No RRSIG').
      No RRSIG found, but there should have been one present.
   30: DNSKEY missing.
      No DNSKEY found, but there should have been one present.
   31: DS missing.
      No DS record found, but there should have been one present.
   32: NSEC missing.
      No NSEC record found, but there should have been one present.
   33: Duplicate Key Tag.
      Multiple keys with the same key tag have been detected.
   34: Conflicting Proofs  (was '33 -- Conflicting Proofs').
      Conflicting valid proofs for an assertion.
   35: Unknown algorithm  (was '18 -- Unknown algorithm').
      DNSKEY, RRSIG or DS algorithm not recognized.
   36: Algorithm not supported (was '14 -- Algo not supported').






Krishnaswamy           Expires September 24, 2005               [Page 4]

Internet-Draft           Validator Return Codes               March 2005


      DNSKEY, RRSIG or DS algorithm not supported.
   37: Wrong RRSIG Owner  (was '50 -- Signer/owner mismatch').
      The RRSIG being used for verification is incorrect for the RR in
      question.
   38: Key Tag mismatch (was '47 -- Key tag mismatch').
      The DNSKEY and the RRSIG have different key-tags.
   39: Unknown DNSKEY protocol.
      The DNSKEY protocol value is not set to 3.
   40: Generic DNS failure  (was '53 -- DNS error').
      Validation not attempted because of early DNS error.
   41: Waiting.
      Waiting for an answer from the resolver.
   42: Watchdog reset/wakeup (was '54 -- Watchdog reset/wakeup').
      Some event was triggered that caused the validator to resume its
      processing.

2.5  **** Author's note *******

   The following error codes I've not categorized as yet for four
   reasons: either because I felt that they were already covered
   elsewhere, that they are related to the resolver functionality, that
   they are not detectable, or because I've not understood what these
   codes were trying to describe.

   Already covered:
      12  Ambiguous : same as 6
      19  Zone is self signed : same as 5
      20  Server not responsive : same as 40
      23  valid, but expired : Same as 20
      30  Can't validate RRSIG : Same as 18
      34  Cached NSEC conflicts with positive response just received :
      same as 34
      38  DNAME expansion failure : same as 6
      25  DS RR does not match DNSKEY : Same as 5
      41  Not a DNSSEC key : Same as -3
      51  Unsupported hash : Same as 36
      52  Unsupported Algo : Same as 36

   Resolver behaviour related:
      24  DNSSEC version mismatch
      29  Flood attack detected
      39  Unsupported EDNS0 label type
      42  label count wrong
      43  EDNS version error
      44  Useless bit set funny
      49  Duplicate RRs

   Not detectable:



Krishnaswamy           Expires September 24, 2005               [Page 5]

Internet-Draft           Validator Return Codes               March 2005


      32  Ex post facto policy violated.

   Not sure what these are:
      31  Security data truncated
      35  Missing security data
      55  No safety belt

3.  Security Considerations

   There are no security considerations for the topics covered in this
   document.

4.  Acknowledgements

   Whole bunch of names to appear here.
































Krishnaswamy           Expires September 24, 2005               [Page 6]


